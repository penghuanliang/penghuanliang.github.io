<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title><![CDATA[官网基础]]></title>
      <url>/2018/01/15/%E5%AE%98%E7%BD%91%E5%9F%BA%E7%A1%80/</url>
      <content type="html"><![CDATA[<h2 id="官网基础"><a href="#官网基础" class="headerlink" title="官网基础"></a>官网基础</h2><p><strong>定义样式</strong></p>
<p>要创建一组样式，请在您的项目的 <code>res/values/</code> 目录中保存一个 XML 文件。 可任意指定该 XML 文件的名称，但它必须使用 <code>.xml</code> 扩展名，并且必须保存在 <code>res/values/</code> 文件夹内。</p>
<p>该 XML 文件的根节点必须是 <code>&lt;resources&gt;</code>。</p>
<p>对于您想创建的每个样式，向该文件添加一个 <code>&lt;style&gt;</code> 元素，该元素带有对样式进行唯一标识的 <code>name</code> 属性（该属性为必需属性）。然后为该样式的每个属性添加一个 <code>&lt;item&gt;</code> 元素，该元素带有声明样式属性以及属性值的 <code>name</code>（该属性为必需属性）。 根据样式属性，<code>&lt;item&gt;</code> 的值可以是关键字字符串、十六进制颜色值、对另一资源类型的引用或其他值。以下是一个包含单个样式的示例文件：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"utf-8"</span>?&gt;</div><div class="line">&lt;resources&gt;</div><div class="line">    &lt;style name=<span class="string">"CodeFont"</span> parent=<span class="string">"@android:style/TextAppearance.Medium"</span>&gt;</div><div class="line">        &lt;item name="android:layout_width"&gt;fill_parent&lt;/item&gt;</div><div class="line">        &lt;item name="android:layout_height"&gt;wrap_content&lt;/item&gt;</div><div class="line">        &lt;item name="android:textColor"&gt;#00FF00&lt;/item&gt;</div><div class="line">        &lt;item name="android:typeface"&gt;monospace&lt;/item&gt;</div><div class="line">    &lt;/style&gt;</div><div class="line">&lt;/resources&gt;</div></pre></td></tr></table></figure>
<p><code>&lt;resources&gt;</code> 元素的每个子项都会在编译时转换成一个应用资源对象，该对象可由 <code>&lt;style&gt;</code> 元素的 <code>name</code> 属性中的值引用。 可从 XML 布局以 <code>@style/CodeFont</code> 形式引用该示例样式（如上文引言中所示）。</p>
<p><code>&lt;style&gt;</code> 元素中的 <code>parent</code> 属性是可选属性，它指定应作为此样式所继承属性来源的另一样式的资源 ID。 如果愿意，您可在随后替换这些继承的样式属性。</p>
<p>​</p>
<h5 id="Fragment"><a href="#Fragment" class="headerlink" title="Fragment"></a>Fragment</h5><p><strong>向应用栏添加项目</strong></p>
<p>您的片段可以通过实现 <code>onCreateOptionsMenu()</code> 向 Activity 的<a href="https://developer.android.google.cn/guide/topics/ui/menus.html#options-menu" target="_blank" rel="external">选项菜单</a>（并因此向<a href="https://developer.android.google.cn/training/appbar/index.html" target="_blank" rel="external">应用栏</a>）贡献菜单项。不过，为了使此方法能够收到调用，您必须在<code>onCreate()</code> 期间调用 <code>setHasOptionsMenu()</code>，以指示片段想要向选项菜单添加菜单项（否则，片段将不会收到对 <code>onCreateOptionsMenu()</code> 的调用）。</p>
<p>您之后从片段添加到选项菜单的任何菜单项都将追加到现有菜单项之后。 选定菜单项时，片段还会收到对 <code>onOptionsItemSelected()</code> 的回调。</p>
<p>您还可以通过调用 <code>registerForContextMenu()</code>，在片段布局中注册一个视图来提供上下文菜单。用户打开上下文菜单时，片段会收到对<code>onCreateContextMenu()</code> 的调用。当用户选择某个菜单项时，片段会收到对 <code>onContextItemSelected()</code> 的调用。</p>
<blockquote>
<p><strong>注</strong>：尽管您的片段会收到与其添加的每个菜单项对应的菜单项选定回调，但当用户选择菜单项时，Activity 会首先收到相应的回调。 如果 Activity 对菜单项选定回调的实现不会处理选定的菜单项，则系统会将事件传递到片段的回调。 这适用于选项菜单和上下文菜单。</p>
</blockquote>
<p><strong>intent</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//验证是否存在接收intent的应用</span></div><div class="line">PackageManager packageManager = getPackageManager();</div><div class="line">List activities = packageManager.queryIntentActivities(intent,</div><div class="line">        PackageManager.MATCH_DEFAULT_ONLY);</div><div class="line"><span class="keyword">boolean</span> isIntentSafe = activities.size() &gt; <span class="number">0</span>;</div><div class="line"><span class="comment">//添加意图选择</span></div><div class="line">Intent intent = <span class="keyword">new</span> Intent(Intent.ACTION_SEND);</div><div class="line">...</div><div class="line"></div><div class="line"><span class="comment">// Always use string resources for UI text.</span></div><div class="line"><span class="comment">// This says something like "Share this photo with"</span></div><div class="line">String title = getResources().getString(R.string.chooser_title);</div><div class="line"><span class="comment">// Create intent to show chooser</span></div><div class="line">Intent chooser = Intent.createChooser(intent, title);</div><div class="line"></div><div class="line"><span class="comment">// Verify the intent will resolve to at least one activity</span></div><div class="line"><span class="keyword">if</span> (intent.resolveActivity(getPackageManager()) != <span class="keyword">null</span>) &#123;</div><div class="line">    startActivity(chooser);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">&lt;！--隐式启动--&gt;</div><div class="line">&lt;activity android:name=<span class="string">"ShareActivity"</span>&gt;</div><div class="line">&lt;!-- filter <span class="keyword">for</span> sending text; accepts SENDTO action with sms URI schemes --&gt;</div><div class="line">&lt;intent-filter&gt;</div><div class="line">    &lt;action android:name=<span class="string">"android.intent.action.SENDTO"</span>/&gt;</div><div class="line">    &lt;category android:name=<span class="string">"android.intent.category.DEFAULT"</span>/&gt;</div><div class="line">    &lt;data android:scheme=<span class="string">"sms"</span> /&gt;</div><div class="line">    &lt;data android:scheme=<span class="string">"smsto"</span> /&gt;</div><div class="line">&lt;/intent-filter&gt;</div><div class="line">&lt;!-- filter <span class="keyword">for</span> sending text or images; accepts SEND action and text or image data --&gt;</div><div class="line">&lt;intent-filter&gt;</div><div class="line">    &lt;action android:name=<span class="string">"android.intent.action.SEND"</span>/&gt;</div><div class="line">    &lt;category android:name=<span class="string">"android.intent.category.DEFAULT"</span>/&gt;</div><div class="line">    &lt;data android:mimeType=<span class="string">"image/*"</span>/&gt;</div><div class="line">    &lt;data android:mimeType=<span class="string">"text/plain"</span>/&gt;</div><div class="line">&lt;/intent-filter&gt;</div><div class="line">&lt;/activity&gt;</div><div class="line"></div><div class="line"><span class="comment">// Get the intent that started this activity</span></div><div class="line"></div><div class="line">Intent intent = getIntent();</div><div class="line">Uri data = intent.getData();</div><div class="line"><span class="comment">// Figure out what to do based on the intent type</span></div><div class="line"><span class="keyword">if</span> (intent.getType().indexOf(<span class="string">"image/"</span>) != -<span class="number">1</span>) &#123;</div><div class="line">    <span class="comment">// Handle intents with image data ...</span></div><div class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (intent.getType().equals(<span class="string">"text/plain"</span>)) &#123;</div><div class="line">    <span class="comment">// Handle intents with text ...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>危险权限申请</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Here, thisActivity is the current activity</span></div><div class="line"><span class="keyword">if</span> (ContextCompat.checkSelfPermission(thisActivity,</div><div class="line">                Manifest.permission.READ_CONTACTS)</div><div class="line">        != PackageManager.PERMISSION_GRANTED) &#123;</div><div class="line"></div><div class="line">    <span class="comment">// Should we show an explanation?</span></div><div class="line">    <span class="keyword">if</span> (ActivityCompat.shouldShowRequestPermissionRationale(thisActivity,</div><div class="line">            Manifest.permission.READ_CONTACTS)) &#123;</div><div class="line"></div><div class="line">        <span class="comment">// Show an expanation to the user *asynchronously* -- don't block</span></div><div class="line">        <span class="comment">// this thread waiting for the user's response! After the user</span></div><div class="line">        <span class="comment">// sees the explanation, try again to request the permission.</span></div><div class="line"></div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line"></div><div class="line">        <span class="comment">// No explanation needed, we can request the permission.</span></div><div class="line"></div><div class="line">        ActivityCompat.requestPermissions(thisActivity,</div><div class="line">                <span class="keyword">new</span> String[]&#123;Manifest.permission.READ_CONTACTS&#125;,</div><div class="line">                MY_PERMISSIONS_REQUEST_READ_CONTACTS);</div><div class="line"></div><div class="line">        <span class="comment">// MY_PERMISSIONS_REQUEST_READ_CONTACTS is an</span></div><div class="line">        <span class="comment">// app-defined int constant. The callback method gets the</span></div><div class="line">        <span class="comment">// result of the request.</span></div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//处理回调</span></div><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onRequestPermissionsResult</span><span class="params">(<span class="keyword">int</span> requestCode,</span></span></div><div class="line"><span class="function"><span class="params">        String permissions[], <span class="keyword">int</span>[] grantResults)</span> </span>&#123;</div><div class="line">    <span class="keyword">switch</span> (requestCode) &#123;</div><div class="line">        <span class="keyword">case</span> MY_PERMISSIONS_REQUEST_READ_CONTACTS: &#123;</div><div class="line">            <span class="comment">// If request is cancelled, the result arrays are empty.</span></div><div class="line">            <span class="keyword">if</span> (grantResults.length &gt; <span class="number">0</span></div><div class="line">                &amp;&amp; grantResults[<span class="number">0</span>] == PackageManager.PERMISSION_GRANTED) &#123;</div><div class="line"></div><div class="line">                <span class="comment">// permission was granted, yay! Do the</span></div><div class="line">                <span class="comment">// contacts-related task you need to do.</span></div><div class="line"></div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line"></div><div class="line">                <span class="comment">// permission denied, boo! Disable the</span></div><div class="line">                <span class="comment">// functionality that depends on this permission.</span></div><div class="line">            &#125;</div><div class="line">            <span class="keyword">return</span>;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">// other 'case' lines to check for other</span></div><div class="line">        <span class="comment">// permissions this app might request</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>文件IO</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//基础写</span></div><div class="line">String filename = <span class="string">"myfile"</span>;</div><div class="line">String string = <span class="string">"Hello world!"</span>;</div><div class="line">FileOutputStream outputStream;</div><div class="line"></div><div class="line"><span class="keyword">try</span> &#123;</div><div class="line">  outputStream = openFileOutput(filename, Context.MODE_PRIVATE);</div><div class="line">  outputStream.write(string.getBytes());</div><div class="line">  outputStream.close();</div><div class="line">&#125; <span class="keyword">catch</span> (Exception e) &#123;</div><div class="line">  e.printStackTrace();</div><div class="line">&#125;</div><div class="line"><span class="comment">//临时文件</span></div><div class="line">String fileName = Uri.parse(url).getLastPathSegment();</div><div class="line">file = File.createTempFile(fileName, <span class="keyword">null</span>, context.getCacheDir());</div><div class="line"></div><div class="line"><span class="comment">//判断外部存储是否装载</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isExternalStorageWritable</span><span class="params">()</span> </span>&#123;</div><div class="line">    String state = Environment.getExternalStorageState();</div><div class="line">    <span class="keyword">if</span> (Environment.MEDIA_MOUNTED.equals(state)) &#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//判断外部存储是否可读</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isExternalStorageReadable</span><span class="params">()</span> </span>&#123;</div><div class="line">    String state = Environment.getExternalStorageState();</div><div class="line">    <span class="keyword">if</span> (Environment.MEDIA_MOUNTED.equals(state) ||</div><div class="line">        Environment.MEDIA_MOUNTED_READ_ONLY.equals(state)) &#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">&#125;</div><div class="line"> <span class="comment">// 指定文件外部存储目录，可以传null.</span></div><div class="line">    File file = <span class="keyword">new</span> File(context.getExternalFilesDir(</div><div class="line">            Environment.DIRECTORY_PICTURES), albumName);</div><div class="line"><span class="comment">//查询存储使用信息</span></div><div class="line">getCacheDir().getFreeSpace()</div><div class="line">getCacheDir().getTotalSpace()</div></pre></td></tr></table></figure>
<p>room数据库的使用：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//By default, Room creates a column for each field that's defined in the entity. </span></div><div class="line"><span class="comment">//If an entity has fields that you don't want to persist, you can annotate them using @Ignore. </span></div><div class="line"><span class="comment">//You must reference the entity class through the entities array in the Database class.</span></div><div class="line"><span class="meta">@Entity</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</div><div class="line">    <span class="meta">@PrimaryKey</span></div><div class="line">    <span class="keyword">public</span> <span class="keyword">int</span> id;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> String firstName;</div><div class="line">    <span class="keyword">public</span> String lastName;</div><div class="line"></div><div class="line">    <span class="meta">@Ignore</span></div><div class="line">    Bitmap picture;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//复合型主键</span></div><div class="line"><span class="meta">@Entity</span>(primaryKeys = &#123;<span class="string">"firstName"</span>, <span class="string">"lastName"</span>&#125;)</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</div><div class="line">    <span class="keyword">public</span> String firstName;</div><div class="line">    <span class="keyword">public</span> String lastName;</div><div class="line"></div><div class="line">    <span class="meta">@Ignore</span></div><div class="line">    Bitmap picture;</div><div class="line">&#125;</div><div class="line"><span class="comment">//表重命名，否则就是以类名作为表的名字  （注意：表名不区分大小写）</span></div><div class="line"><span class="meta">@Entity</span>(primaryKeys = &#123;<span class="string">"firstName"</span>, <span class="string">"lastName"</span>&#125;)</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</div><div class="line">    <span class="keyword">public</span> String firstName;</div><div class="line">    <span class="keyword">public</span> String lastName;</div><div class="line"></div><div class="line">    <span class="meta">@Ignore</span></div><div class="line">    Bitmap picture;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//columnInfo 作用与tableName相似，声明的字段会作为表的列明，通过@columnInfo可修改列名</span></div><div class="line"><span class="meta">@Entity</span>(tableName = <span class="string">"users"</span>)</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</div><div class="line">    <span class="meta">@PrimaryKey</span></div><div class="line">    <span class="keyword">public</span> <span class="keyword">int</span> id;</div><div class="line"></div><div class="line">    <span class="meta">@ColumnInfo</span>(name = <span class="string">"first_name"</span>)</div><div class="line">    <span class="keyword">public</span> String firstName;</div><div class="line"></div><div class="line">    <span class="meta">@ColumnInfo</span>(name = <span class="string">"last_name"</span>)</div><div class="line">    <span class="keyword">public</span> String lastName;</div><div class="line"></div><div class="line">    <span class="meta">@Ignore</span></div><div class="line">    Bitmap picture;</div><div class="line">&#125;</div><div class="line"><span class="comment">//定义对象之间的关系（）</span></div><div class="line"><span class="meta">@Entity</span>(foreignKeys = <span class="meta">@ForeignKey</span>(entity = User.class,</div><div class="line">                                  parentColumns = <span class="string">"id"</span>,</div><div class="line">                                  childColumns = <span class="string">"user_id"</span>))</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Book</span> </span>&#123;</div><div class="line">    <span class="meta">@PrimaryKey</span></div><div class="line">    <span class="keyword">public</span> <span class="keyword">int</span> bookId;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> String title;</div><div class="line"></div><div class="line">    <span class="meta">@ColumnInfo</span>(name = <span class="string">"user_id"</span>)</div><div class="line">    <span class="keyword">public</span> <span class="keyword">int</span> userId;</div><div class="line">&#125;</div><div class="line"><span class="comment">//使用注解@Embedded创建嵌套对象 （User表中包含Address的street，state,city,post_code）</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Address</span> </span>&#123;</div><div class="line">    <span class="keyword">public</span> String street;</div><div class="line">    <span class="keyword">public</span> String state;</div><div class="line">    <span class="keyword">public</span> String city;</div><div class="line"></div><div class="line">    <span class="meta">@ColumnInfo</span>(name = <span class="string">"post_code"</span>)</div><div class="line">    <span class="keyword">public</span> <span class="keyword">int</span> postCode;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="meta">@Entity</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</div><div class="line">    <span class="meta">@PrimaryKey</span></div><div class="line">    <span class="keyword">public</span> <span class="keyword">int</span> id;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> String firstName;</div><div class="line"></div><div class="line">    <span class="meta">@Embedded</span></div><div class="line">    <span class="keyword">public</span> Address address;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>相机</p>
<p>要求相关硬件</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;manifest ... &gt;</div><div class="line">    &lt;uses-feature android:name=<span class="string">"android.hardware.camera"</span></div><div class="line">                  android:required=<span class="string">"true"</span> /&gt;</div><div class="line">    ...</div><div class="line">&lt;/manifest&gt;</div></pre></td></tr></table></figure>
<p>简单拍照/获取缩略图</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> REQUEST_IMAGE_CAPTURE = <span class="number">1</span>;</div><div class="line"><span class="comment">//拍照</span></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">dispatchTakePictureIntent</span><span class="params">()</span> </span>&#123;</div><div class="line">    Intent takePictureIntent = <span class="keyword">new</span> Intent(MediaStore.ACTION_IMAGE_CAPTURE);</div><div class="line">    <span class="keyword">if</span> (takePictureIntent.resolveActivity(getPackageManager()) != <span class="keyword">null</span>) &#123;</div><div class="line">        startActivityForResult(takePictureIntent, REQUEST_IMAGE_CAPTURE);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//获取缩略图</span></div><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onActivityResult</span><span class="params">(<span class="keyword">int</span> requestCode, <span class="keyword">int</span> resultCode, Intent data)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (requestCode == REQUEST_IMAGE_CAPTURE &amp;&amp; resultCode == RESULT_OK) &#123;</div><div class="line">        Bundle extras = data.getExtras();</div><div class="line">        Bitmap imageBitmap = (Bitmap) extras.get(<span class="string">"data"</span>);</div><div class="line">        mImageView.setImageBitmap(imageBitmap);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>获取唯一文件</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">String mCurrentPhotoPath;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> File <span class="title">createImageFile</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</div><div class="line">    <span class="comment">// Create an image file name</span></div><div class="line">    String timeStamp = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyyMMdd_HHmmss"</span>).format(<span class="keyword">new</span> Date());</div><div class="line">    String imageFileName = <span class="string">"JPEG_"</span> + timeStamp + <span class="string">"_"</span>;</div><div class="line">    File storageDir = getExternalFilesDir(Environment.DIRECTORY_PICTURES);</div><div class="line">    File image = File.createTempFile(</div><div class="line">        imageFileName,  <span class="comment">/* prefix */</span></div><div class="line">        <span class="string">".jpg"</span>,         <span class="comment">/* suffix */</span></div><div class="line">        storageDir      <span class="comment">/* directory */</span></div><div class="line">    );</div><div class="line"></div><div class="line">    <span class="comment">// Save a file: path for use with ACTION_VIEW intents</span></div><div class="line">    mCurrentPhotoPath = image.getAbsolutePath();</div><div class="line">    <span class="keyword">return</span> image;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>拍照/原图</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> REQUEST_TAKE_PHOTO = <span class="number">1</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">dispatchTakePictureIntent</span><span class="params">()</span> </span>&#123;</div><div class="line">    Intent takePictureIntent = <span class="keyword">new</span> Intent(MediaStore.ACTION_IMAGE_CAPTURE);</div><div class="line">    <span class="comment">// Ensure that there's a camera activity to handle the intent</span></div><div class="line">    <span class="keyword">if</span> (takePictureIntent.resolveActivity(getPackageManager()) != <span class="keyword">null</span>) &#123;</div><div class="line">        <span class="comment">// Create the File where the photo should go</span></div><div class="line">        File photoFile = <span class="keyword">null</span>;</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            photoFile = createImageFile();</div><div class="line">        &#125; <span class="keyword">catch</span> (IOException ex) &#123;</div><div class="line">            <span class="comment">// Error occurred while creating the File</span></div><div class="line">            ...</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// Continue only if the File was successfully created</span></div><div class="line">        <span class="keyword">if</span> (photoFile != <span class="keyword">null</span>) &#123;</div><div class="line">            Uri photoURI = FileProvider.getUriForFile(<span class="keyword">this</span>,</div><div class="line">                                                  <span class="string">"com.example.android.fileprovider"</span>,</div><div class="line">                                                  photoFile);</div><div class="line">            takePictureIntent.putExtra(MediaStore.EXTRA_OUTPUT, photoURI);</div><div class="line">            startActivityForResult(takePictureIntent, REQUEST_TAKE_PHOTO);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>通知图库更新</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//可以让其他应用访问</span></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">galleryAddPic</span><span class="params">()</span> </span>&#123;</div><div class="line">    Intent mediaScanIntent = <span class="keyword">new</span> Intent(Intent.ACTION_MEDIA_SCANNER_SCAN_FILE);</div><div class="line">    File f = <span class="keyword">new</span> File(mCurrentPhotoPath);</div><div class="line">    Uri contentUri = Uri.fromFile(f);</div><div class="line">    mediaScanIntent.setData(contentUri);</div><div class="line">    <span class="keyword">this</span>.sendBroadcast(mediaScanIntent);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>尺寸压缩</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">setPic</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="comment">// Get the dimensions of the View</span></div><div class="line">    <span class="keyword">int</span> targetW = mImageView.getWidth();</div><div class="line">    <span class="keyword">int</span> targetH = mImageView.getHeight();</div><div class="line"></div><div class="line">    <span class="comment">// Get the dimensions of the bitmap</span></div><div class="line">    BitmapFactory.Options bmOptions = <span class="keyword">new</span> BitmapFactory.Options();</div><div class="line">    bmOptions.inJustDecodeBounds = <span class="keyword">true</span>;</div><div class="line">    BitmapFactory.decodeFile(mCurrentPhotoPath, bmOptions);</div><div class="line">    <span class="keyword">int</span> photoW = bmOptions.outWidth;</div><div class="line">    <span class="keyword">int</span> photoH = bmOptions.outHeight;</div><div class="line"></div><div class="line">    <span class="comment">// Determine how much to scale down the image</span></div><div class="line">    <span class="keyword">int</span> scaleFactor = Math.min(photoW/targetW, photoH/targetH);</div><div class="line"></div><div class="line">    <span class="comment">// Decode the image file into a Bitmap sized to fill the View</span></div><div class="line">    bmOptions.inJustDecodeBounds = <span class="keyword">false</span>;</div><div class="line">    bmOptions.inSampleSize = scaleFactor;</div><div class="line">    bmOptions.inPurgeable = <span class="keyword">true</span>;</div><div class="line"></div><div class="line">    Bitmap bitmap = BitmapFactory.decodeFile(mCurrentPhotoPath, bmOptions);</div><div class="line">    mImageView.setImageBitmap(bitmap);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>调用相机录制视频</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//添加 &lt;uses-feature android:name="android.hardware.camera" android:required="true" /&gt;</span></div><div class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> REQUEST_VIDEO_CAPTURE = <span class="number">1</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">dispatchTakeVideoIntent</span><span class="params">()</span> </span>&#123;</div><div class="line">    Intent takeVideoIntent = <span class="keyword">new</span> Intent(MediaStore.ACTION_VIDEO_CAPTURE);</div><div class="line">    <span class="keyword">if</span> (takeVideoIntent.resolveActivity(getPackageManager()) != <span class="keyword">null</span>) &#123;</div><div class="line">        startActivityForResult(takeVideoIntent, REQUEST_VIDEO_CAPTURE);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//通过使用videoView播放</span></div><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onActivityResult</span><span class="params">(<span class="keyword">int</span> requestCode, <span class="keyword">int</span> resultCode, Intent intent)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (requestCode == REQUEST_VIDEO_CAPTURE &amp;&amp; resultCode == RESULT_OK) &#123;</div><div class="line">        Uri videoUri = intent.getData();</div><div class="line">        mVideoView.setVideoURI(videoUri);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Sence</p>
<p>布局生成Sence</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">Scene mAScene;</div><div class="line">Scene mAnotherScene;</div><div class="line"></div><div class="line"><span class="comment">// Create the scene root for the scenes in this app</span></div><div class="line">mSceneRoot = (ViewGroup) findViewById(R.id.scene_root);</div><div class="line"></div><div class="line"><span class="comment">// Create the scenes</span></div><div class="line">mAScene = Scene.getSceneForLayout(mSceneRoot, R.layout.a_scene, <span class="keyword">this</span>);</div><div class="line">mAnotherScene =</div><div class="line">    Scene.getSceneForLayout(mSceneRoot, R.layout.another_scene, <span class="keyword">this</span>);</div></pre></td></tr></table></figure>
<p>代码创建Sence</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">Scene mScene;</div><div class="line"></div><div class="line"><span class="comment">// Obtain the scene root element</span></div><div class="line">mSceneRoot = (ViewGroup) mSomeLayoutElement;</div><div class="line"></div><div class="line"><span class="comment">// Obtain the view hierarchy to add as a child of</span></div><div class="line"><span class="comment">// the scene root when this scene is entered</span></div><div class="line">mViewHierarchy = (ViewGroup) someOtherLayoutElement;</div><div class="line"></div><div class="line"><span class="comment">// Create a scene</span></div><div class="line">mScene = <span class="keyword">new</span> Scene(mSceneRoot, mViewHierarchy);</div></pre></td></tr></table></figure>
<p>Transition的创建</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//通过布局的方式创建</span></div><div class="line"><span class="comment">//res/transition/fade_transition.xml</span></div><div class="line">&lt;fade xmlns:android=<span class="string">"http://schemas.android.com/apk/res/android"</span> /&gt;</div><div class="line"></div><div class="line">Transition mFadeTransition =</div><div class="line">        TransitionInflater.from(<span class="keyword">this</span>).</div><div class="line">        inflateTransition(R.transition.fade_transition);</div><div class="line"></div><div class="line"><span class="comment">//通过代码的方式创建Transition [AutoTransition,Fade,ChangeBounds]</span></div><div class="line">Transition mFadeTransition = <span class="keyword">new</span> Fade();</div></pre></td></tr></table></figure>
<p>Transition应用有场景的转换</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//通常用于不同的视图切换</span></div><div class="line">TransitionManager.go(mEndingScene, mFadeTransition);</div></pre></td></tr></table></figure>
<p>Transition应用无场景的转换(TransitionManager.beginDelayedTransition(rootview,flag) 用于记录视图层次结构)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Get the root view and create a transition</span></div><div class="line">mRootView = (ViewGroup) findViewById(R.id.mainLayout);</div><div class="line">mFade = <span class="keyword">new</span> Fade(IN);</div><div class="line"></div><div class="line"><span class="comment">// Start recording changes to the view hierarchy</span></div><div class="line">TransitionManager.beginDelayedTransition(mRootView, mFade);</div><div class="line"></div><div class="line"><span class="comment">// Add the new TextView to the view hierarchy</span></div><div class="line">mRootView.addView(mLabelText);</div><div class="line"></div><div class="line"><span class="comment">// When the system redraws the screen to show this update,</span></div><div class="line"><span class="comment">// the framework will animate the addition as a fade in</span></div></pre></td></tr></table></figure>
<p>PageTransformer</p>
<p>缩放效果（<a href="https://developer.android.google.cn/training/animation/anim_page_transformer_zoomout.mp4）" target="_blank" rel="external">https://developer.android.google.cn/training/animation/anim_page_transformer_zoomout.mp4）</a></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ZoomOutPageTransformer</span> <span class="keyword">implements</span> <span class="title">ViewPager</span>.<span class="title">PageTransformer</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">float</span> MIN_SCALE = <span class="number">0.85f</span>;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">float</span> MIN_ALPHA = <span class="number">0.5f</span>;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">transformPage</span><span class="params">(View view, <span class="keyword">float</span> position)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> pageWidth = view.getWidth();</div><div class="line">        <span class="keyword">int</span> pageHeight = view.getHeight();</div><div class="line"></div><div class="line">        <span class="keyword">if</span> (position &lt; -<span class="number">1</span>) &#123; <span class="comment">// [-Infinity,-1)</span></div><div class="line">            <span class="comment">// This page is way off-screen to the left.</span></div><div class="line">            view.setAlpha(<span class="number">0</span>);</div><div class="line"></div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (position &lt;= <span class="number">1</span>) &#123; <span class="comment">// [-1,1]</span></div><div class="line">            <span class="comment">// Modify the default slide transition to shrink the page as well</span></div><div class="line">            <span class="keyword">float</span> scaleFactor = Math.max(MIN_SCALE, <span class="number">1</span> - Math.abs(position));</div><div class="line">            <span class="keyword">float</span> vertMargin = pageHeight * (<span class="number">1</span> - scaleFactor) / <span class="number">2</span>;</div><div class="line">            <span class="keyword">float</span> horzMargin = pageWidth * (<span class="number">1</span> - scaleFactor) / <span class="number">2</span>;</div><div class="line">            <span class="keyword">if</span> (position &lt; <span class="number">0</span>) &#123;</div><div class="line">                view.setTranslationX(horzMargin - vertMargin / <span class="number">2</span>);</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                view.setTranslationX(-horzMargin + vertMargin / <span class="number">2</span>);</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            <span class="comment">// Scale the page down (between MIN_SCALE and 1)</span></div><div class="line">            view.setScaleX(scaleFactor);</div><div class="line">            view.setScaleY(scaleFactor);</div><div class="line"></div><div class="line">            <span class="comment">// Fade the page relative to its size.</span></div><div class="line">            view.setAlpha(MIN_ALPHA +</div><div class="line">                    (scaleFactor - MIN_SCALE) /</div><div class="line">                    (<span class="number">1</span> - MIN_SCALE) * (<span class="number">1</span> - MIN_ALPHA));</div><div class="line"></div><div class="line">        &#125; <span class="keyword">else</span> &#123; <span class="comment">// (1,+Infinity]</span></div><div class="line">            <span class="comment">// This page is way off-screen to the right.</span></div><div class="line">            view.setAlpha(<span class="number">0</span>);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>透明效果（<a href="https://developer.android.google.cn/training/animation/anim_page_transformer_depth.mp4）" target="_blank" rel="external">https://developer.android.google.cn/training/animation/anim_page_transformer_depth.mp4）</a></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DepthPageTransformer</span> <span class="keyword">implements</span> <span class="title">ViewPager</span>.<span class="title">PageTransformer</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">float</span> MIN_SCALE = <span class="number">0.75f</span>;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">transformPage</span><span class="params">(View view, <span class="keyword">float</span> position)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> pageWidth = view.getWidth();</div><div class="line"></div><div class="line">        <span class="keyword">if</span> (position &lt; -<span class="number">1</span>) &#123; <span class="comment">// [-Infinity,-1)</span></div><div class="line">            <span class="comment">// This page is way off-screen to the left.</span></div><div class="line">            view.setAlpha(<span class="number">0</span>);</div><div class="line"></div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (position &lt;= <span class="number">0</span>) &#123; <span class="comment">// [-1,0]</span></div><div class="line">            <span class="comment">// Use the default slide transition when moving to the left page</span></div><div class="line">            view.setAlpha(<span class="number">1</span>);</div><div class="line">            view.setTranslationX(<span class="number">0</span>);</div><div class="line">            view.setScaleX(<span class="number">1</span>);</div><div class="line">            view.setScaleY(<span class="number">1</span>);</div><div class="line"></div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (position &lt;= <span class="number">1</span>) &#123; <span class="comment">// (0,1]</span></div><div class="line">            <span class="comment">// Fade the page out.</span></div><div class="line">            view.setAlpha(<span class="number">1</span> - position);</div><div class="line"></div><div class="line">            <span class="comment">// Counteract the default slide transition</span></div><div class="line">            view.setTranslationX(pageWidth * -position);</div><div class="line"></div><div class="line">            <span class="comment">// Scale the page down (between MIN_SCALE and 1)</span></div><div class="line">            <span class="keyword">float</span> scaleFactor = MIN_SCALE</div><div class="line">                    + (<span class="number">1</span> - MIN_SCALE) * (<span class="number">1</span> - Math.abs(position));</div><div class="line">            view.setScaleX(scaleFactor);</div><div class="line">            view.setScaleY(scaleFactor);</div><div class="line"></div><div class="line">        &#125; <span class="keyword">else</span> &#123; <span class="comment">// (1,+Infinity]</span></div><div class="line">            <span class="comment">// This page is way off-screen to the right.</span></div><div class="line">            view.setAlpha(<span class="number">0</span>);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>查看大图(<a href="https://developer.android.google.cn/training/animation/anim_zoom.mp4" target="_blank" rel="external">https://developer.android.google.cn/training/animation/anim_zoom.mp4</a>)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">zoomImageFromThumb</span><span class="params">(<span class="keyword">final</span> View thumbView, <span class="keyword">int</span> imageResId)</span> </span>&#123;</div><div class="line">    <span class="comment">// If there's an animation in progress, cancel it</span></div><div class="line">    <span class="comment">// immediately and proceed with this one.</span></div><div class="line">    <span class="keyword">if</span> (mCurrentAnimator != <span class="keyword">null</span>) &#123;</div><div class="line">        mCurrentAnimator.cancel();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// Load the high-resolution "zoomed-in" image.</span></div><div class="line">    <span class="keyword">final</span> ImageView expandedImageView = (ImageView) findViewById(</div><div class="line">            R.id.expanded_image);</div><div class="line">    expandedImageView.setImageResource(imageResId);</div><div class="line"></div><div class="line">    <span class="comment">// Calculate the starting and ending bounds for the zoomed-in image.</span></div><div class="line">    <span class="comment">// This step involves lots of math. Yay, math.</span></div><div class="line">    <span class="keyword">final</span> Rect startBounds = <span class="keyword">new</span> Rect();</div><div class="line">    <span class="keyword">final</span> Rect finalBounds = <span class="keyword">new</span> Rect();</div><div class="line">    <span class="keyword">final</span> Point globalOffset = <span class="keyword">new</span> Point();</div><div class="line"></div><div class="line">    <span class="comment">// The start bounds are the global visible rectangle of the thumbnail,</span></div><div class="line">    <span class="comment">// and the final bounds are the global visible rectangle of the container</span></div><div class="line">    <span class="comment">// view. Also set the container view's offset as the origin for the</span></div><div class="line">    <span class="comment">// bounds, since that's the origin for the positioning animation</span></div><div class="line">    <span class="comment">// properties (X, Y).</span></div><div class="line">    thumbView.getGlobalVisibleRect(startBounds);</div><div class="line">    findViewById(R.id.container)</div><div class="line">            .getGlobalVisibleRect(finalBounds, globalOffset);</div><div class="line">    startBounds.offset(-globalOffset.x, -globalOffset.y);</div><div class="line">    finalBounds.offset(-globalOffset.x, -globalOffset.y);</div><div class="line"></div><div class="line">    <span class="comment">// Adjust the start bounds to be the same aspect ratio as the final</span></div><div class="line">    <span class="comment">// bounds using the "center crop" technique. This prevents undesirable</span></div><div class="line">    <span class="comment">// stretching during the animation. Also calculate the start scaling</span></div><div class="line">    <span class="comment">// factor (the end scaling factor is always 1.0).</span></div><div class="line">    <span class="keyword">float</span> startScale;</div><div class="line">    <span class="keyword">if</span> ((<span class="keyword">float</span>) finalBounds.width() / finalBounds.height()</div><div class="line">            &gt; (<span class="keyword">float</span>) startBounds.width() / startBounds.height()) &#123;</div><div class="line">        <span class="comment">// Extend start bounds horizontally</span></div><div class="line">        startScale = (<span class="keyword">float</span>) startBounds.height() / finalBounds.height();</div><div class="line">        <span class="keyword">float</span> startWidth = startScale * finalBounds.width();</div><div class="line">        <span class="keyword">float</span> deltaWidth = (startWidth - startBounds.width()) / <span class="number">2</span>;</div><div class="line">        startBounds.left -= deltaWidth;</div><div class="line">        startBounds.right += deltaWidth;</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        <span class="comment">// Extend start bounds vertically</span></div><div class="line">        startScale = (<span class="keyword">float</span>) startBounds.width() / finalBounds.width();</div><div class="line">        <span class="keyword">float</span> startHeight = startScale * finalBounds.height();</div><div class="line">        <span class="keyword">float</span> deltaHeight = (startHeight - startBounds.height()) / <span class="number">2</span>;</div><div class="line">        startBounds.top -= deltaHeight;</div><div class="line">        startBounds.bottom += deltaHeight;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// Hide the thumbnail and show the zoomed-in view. When the animation</span></div><div class="line">    <span class="comment">// begins, it will position the zoomed-in view in the place of the</span></div><div class="line">    <span class="comment">// thumbnail.</span></div><div class="line">    thumbView.setAlpha(<span class="number">0f</span>);</div><div class="line">    expandedImageView.setVisibility(View.VISIBLE);</div><div class="line"></div><div class="line">    <span class="comment">// Set the pivot point for SCALE_X and SCALE_Y transformations</span></div><div class="line">    <span class="comment">// to the top-left corner of the zoomed-in view (the default</span></div><div class="line">    <span class="comment">// is the center of the view).</span></div><div class="line">    expandedImageView.setPivotX(<span class="number">0f</span>);</div><div class="line">    expandedImageView.setPivotY(<span class="number">0f</span>);</div><div class="line"></div><div class="line">    <span class="comment">// Construct and run the parallel animation of the four translation and</span></div><div class="line">    <span class="comment">// scale properties (X, Y, SCALE_X, and SCALE_Y).</span></div><div class="line">    AnimatorSet set = <span class="keyword">new</span> AnimatorSet();</div><div class="line">    set</div><div class="line">            .play(ObjectAnimator.ofFloat(expandedImageView, View.X,</div><div class="line">                    startBounds.left, finalBounds.left))</div><div class="line">            .with(ObjectAnimator.ofFloat(expandedImageView, View.Y,</div><div class="line">                    startBounds.top, finalBounds.top))</div><div class="line">            .with(ObjectAnimator.ofFloat(expandedImageView, View.SCALE_X,</div><div class="line">            startScale, <span class="number">1f</span>)).with(ObjectAnimator.ofFloat(expandedImageView,</div><div class="line">                    View.SCALE_Y, startScale, <span class="number">1f</span>));</div><div class="line">    set.setDuration(mShortAnimationDuration);</div><div class="line">    set.setInterpolator(<span class="keyword">new</span> DecelerateInterpolator());</div><div class="line">    set.addListener(<span class="keyword">new</span> AnimatorListenerAdapter() &#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationEnd</span><span class="params">(Animator animation)</span> </span>&#123;</div><div class="line">            mCurrentAnimator = <span class="keyword">null</span>;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationCancel</span><span class="params">(Animator animation)</span> </span>&#123;</div><div class="line">            mCurrentAnimator = <span class="keyword">null</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">    set.start();</div><div class="line">    mCurrentAnimator = set;</div><div class="line"></div><div class="line">    <span class="comment">// Upon clicking the zoomed-in image, it should zoom back down</span></div><div class="line">    <span class="comment">// to the original bounds and show the thumbnail instead of</span></div><div class="line">    <span class="comment">// the expanded image.</span></div><div class="line">    <span class="keyword">final</span> <span class="keyword">float</span> startScaleFinal = startScale;</div><div class="line">    expandedImageView.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View view)</span> </span>&#123;</div><div class="line">            <span class="keyword">if</span> (mCurrentAnimator != <span class="keyword">null</span>) &#123;</div><div class="line">                mCurrentAnimator.cancel();</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            <span class="comment">// Animate the four positioning/sizing properties in parallel,</span></div><div class="line">            <span class="comment">// back to their original values.</span></div><div class="line">            AnimatorSet set = <span class="keyword">new</span> AnimatorSet();</div><div class="line">            set.play(ObjectAnimator</div><div class="line">                        .ofFloat(expandedImageView, View.X, startBounds.left))</div><div class="line">                        .with(ObjectAnimator</div><div class="line">                                .ofFloat(expandedImageView,</div><div class="line">                                        View.Y,startBounds.top))</div><div class="line">                        .with(ObjectAnimator</div><div class="line">                                .ofFloat(expandedImageView,</div><div class="line">                                        View.SCALE_X, startScaleFinal))</div><div class="line">                        .with(ObjectAnimator</div><div class="line">                                .ofFloat(expandedImageView,</div><div class="line">                                        View.SCALE_Y, startScaleFinal));</div><div class="line">            set.setDuration(mShortAnimationDuration);</div><div class="line">            set.setInterpolator(<span class="keyword">new</span> DecelerateInterpolator());</div><div class="line">            set.addListener(<span class="keyword">new</span> AnimatorListenerAdapter() &#123;</div><div class="line">                <span class="meta">@Override</span></div><div class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationEnd</span><span class="params">(Animator animation)</span> </span>&#123;</div><div class="line">                    thumbView.setAlpha(<span class="number">1f</span>);</div><div class="line">                    expandedImageView.setVisibility(View.GONE);</div><div class="line">                    mCurrentAnimator = <span class="keyword">null</span>;</div><div class="line">                &#125;</div><div class="line"></div><div class="line">                <span class="meta">@Override</span></div><div class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationCancel</span><span class="params">(Animator animation)</span> </span>&#123;</div><div class="line">                    thumbView.setAlpha(<span class="number">1f</span>);</div><div class="line">                    expandedImageView.setVisibility(View.GONE);</div><div class="line">                    mCurrentAnimator = <span class="keyword">null</span>;</div><div class="line">                &#125;</div><div class="line">            &#125;);</div><div class="line">            set.start();</div><div class="line">            mCurrentAnimator = set;</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>更改布局动画（添加、删除、更新）</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!--在相应的布局中添加animateLayoutChanges = true--&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">android:id</span>=<span class="string">"@+id/container"</span></span></div><div class="line"><span class="tag">    <span class="attr">android:animateLayoutChanges</span>=<span class="string">"true"</span></span></div><div class="line"><span class="tag">    <span class="attr">...</span></span></div><div class="line"><span class="tag">/&gt;</span></div></pre></td></tr></table></figure>
<p>尺寸限定符：</p>
<p><code>res/layout/main.xml</code>，单窗格（默认）布局：</p>
<p><code>res/layout-large/main.xml</code>，双窗格布局：    </p>
<p><code>res/layout-sw600dp/main.xml</code>，双窗格布局：（最小宽度大于或等于 600dp 的设备将选择 <code>layout-sw600dp/main.xml</code>）</p>
<p>NinePatch(.9图制作详情)</p>
<blockquote>
<p>边框沿线的黑色像素。顶部和左侧边框上的黑色像素指示可以拉伸图像的位置，右侧和底部边框上的黑色像素则指示应该放置内容的位置。</p>
</blockquote>
<p>DP</p>
<ul>
<li><code>xhdpi</code>：2.0</li>
<li><code>hdpi</code>：1.5</li>
<li><code>mdpi</code>：1.0（基准）</li>
<li><code>ldpi</code>：0.75</li>
</ul>
<p>ConstraintLayout</p>
<blockquote>
<p>官网有详细介绍 <a href="https://developer.android.google.cn/training/constraint-layout/index.html" target="_blank" rel="external">https://developer.android.google.cn/training/constraint-layout/index.html</a></p>
</blockquote>
<ul>
<li><p>Toolbar</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">android.support.v7.widget.Toolbar</span></span></div><div class="line"><span class="tag">   <span class="attr">android:id</span>=<span class="string">"@+id/my_toolbar"</span></span></div><div class="line"><span class="tag">   <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></div><div class="line"><span class="tag">   <span class="attr">android:layout_height</span>=<span class="string">"?attr/actionBarSize"</span></span></div><div class="line"><span class="tag">   <span class="attr">android:background</span>=<span class="string">"?attr/colorPrimary"</span></span></div><div class="line"><span class="tag">   <span class="attr">android:elevation</span>=<span class="string">"4dp"</span> 官方推荐</span></div><div class="line"><span class="tag">   <span class="attr">android:theme</span>=<span class="string">"@style/ThemeOverlay.AppCompat.ActionBar"</span></span></div><div class="line"><span class="tag">   <span class="attr">app:popupTheme</span>=<span class="string">"@style/ThemeOverlay.AppCompat.Light"</span>/&gt;</span></div></pre></td></tr></table></figure>
</li>
<li><p>SearchView</p>
<blockquote>
<p>可以作为menu使用，也可以作为一个控件使用</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">item</span> <span class="attr">android:id</span>=<span class="string">"@+id/action_search"</span></span></div><div class="line"><span class="tag">     <span class="attr">android:title</span>=<span class="string">"@string/action_search"</span></span></div><div class="line"><span class="tag">     <span class="attr">android:icon</span>=<span class="string">"@drawable/ic_search"</span></span></div><div class="line"><span class="tag">     <span class="attr">app:showAsAction</span>=<span class="string">"ifRoom|collapseActionView"</span></span></div><div class="line"><span class="tag">     <span class="attr">app:actionViewClass</span>=<span class="string">"android.support.v7.widget.SearchView"</span> /&gt;</span></div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onCreateOptionsMenu</span><span class="params">(Menu menu)</span> </span>&#123;</div><div class="line">    getMenuInflater().inflate(R.menu.main_activity_actions, menu);</div><div class="line"></div><div class="line">    MenuItem searchItem = menu.findItem(R.id.action_search);</div><div class="line">    SearchView searchView =</div><div class="line">            (SearchView) MenuItemCompat.getActionView(searchItem);</div><div class="line"></div><div class="line">    <span class="comment">// Configure the search info and add any event listeners...</span></div><div class="line"></div><div class="line">    <span class="keyword">return</span> <span class="keyword">super</span>.onCreateOptionsMenu(menu);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//可以自定义各种状态下的icon</span></div><div class="line">actionView.setOnCloseListener();<span class="comment">//监听打开关闭</span></div><div class="line">actionView.setOnSuggestionListener();<span class="comment">//推荐列表        </span></div><div class="line">actionView.setOnQueryTextListener()<span class="comment">//类似文本间监听 返回false自动收起键盘</span></div></pre></td></tr></table></figure>
</li>
<li><p><strong>snackbar</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Snackbar mySnackbar = Snackbar.make(findViewById(R.id.myCoordinatorLayout),</div><div class="line">								R.string.email_archived,Snackbar.LENGTH_SHORT);</div><div class="line">mySnackbar.setAction(R.string.undo_string, <span class="keyword">new</span> MyUndoListener());</div><div class="line">mySnackbar.show();</div></pre></td></tr></table></figure>
</li>
<li><p><strong>管理系统界面</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// This example uses decor view, but you can use any visible view.</span></div><div class="line">View decorView = getActivity().getWindow().getDecorView();</div><div class="line"><span class="keyword">int</span> uiOptions = View.SYSTEM_UI_FLAG_LOW_PROFILE;</div><div class="line">decorView.setSystemUiVisibility(uiOptions);</div><div class="line"></div><div class="line">View decorView = getActivity().getWindow().getDecorView();</div><div class="line"><span class="comment">// Calling setSystemUiVisibility() with a value of 0 clears</span></div><div class="line"><span class="comment">// all flags.</span></div><div class="line">decorView.setSystemUiVisibility(<span class="number">0</span>);</div></pre></td></tr></table></figure>
</li>
<li><p>隐藏状态栏</p>
<p>当失去焦点时会无效，比如触摸其他，后台重新进入界面</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line">View decorView = getWindow().getDecorView();</div><div class="line"><span class="comment">// Hide the status bar.</span></div><div class="line"><span class="keyword">int</span> uiOptions = View.SYSTEM_UI_FLAG_FULLSCREEN;</div><div class="line">decorView.setSystemUiVisibility(uiOptions);</div><div class="line"><span class="comment">// Remember that you should never show the action bar if the</span></div><div class="line"><span class="comment">// status bar is hidden, so hide that too if necessary.</span></div><div class="line">ActionBar actionBar = getActionBar();</div><div class="line">actionBar.hide();</div><div class="line"></div><div class="line"><span class="comment">//配合setFitsSystemWindows()</span></div><div class="line">View.SYSTEM_UI_FLAG_FULLSCREEN | <span class="comment">//隐藏状态栏</span></div><div class="line">View.SYSTEM_UI_FLAG_LAYOUT_FULLSCREEN| <span class="comment">//内容填充状态栏</span></div><div class="line">View.SYSTEM_UI_FLAG_LAYOUT_STABLE| <span class="comment">//保持布局稳定</span></div><div class="line">View.SYSTEM_UI_FLAG_HIDE_NAVIGATION|<span class="comment">//隐藏导航虚拟按键</span></div><div class="line">View.SYSTEM_UI_FLAG_LAYOUT_HIDE_NAVIGATION|<span class="comment">//内容填充导航虚拟按键</span></div><div class="line">View.SYSTEM_UI_FLAG_IMMERSIVE|<span class="comment">//沉浸式全屏</span></div><div class="line">View.SYSTEM_UI_FLAG_IMMERSIVE_STICKY<span class="comment">//沉浸式全屏 划出状态栏，状态栏会自动消失</span></div><div class="line"></div><div class="line"><span class="comment">//处理状态栏被显示的问题</span></div><div class="line">getWindow().getDecorView().setOnSystemUiVisibilityChangeListener</div><div class="line">onWindowFocusChanged()</div><div class="line">  </div><div class="line">mDecorView.setOnSystemUiVisibilityChangeListener(<span class="keyword">new</span> View.OnSystemUiVisibilityChangeListener() &#123;</div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSystemUiVisibilityChange</span><span class="params">(<span class="keyword">int</span> visibility)</span> </span>&#123;</div><div class="line">                <span class="comment">// Note that system bars will only be "visible" if none of the</span></div><div class="line">                <span class="comment">// LOW_PROFILE, HIDE_NAVIGATION, or FULLSCREEN flags are set.</span></div><div class="line">                <span class="keyword">if</span> ((visibility &amp; View.SYSTEM_UI_FLAG_FULLSCREEN) == <span class="number">0</span>) &#123;</div><div class="line">                    <span class="comment">// <span class="doctag">TODO:</span> The system bars are visible. Make any desired</span></div><div class="line">                    <span class="comment">// adjustments to your UI, such as showing the action bar or</span></div><div class="line">                    <span class="comment">// other navigational controls.</span></div><div class="line">                  </div><div class="line">                &#125; <span class="keyword">else</span> &#123;</div><div class="line">                    <span class="comment">// <span class="doctag">TODO:</span> The system bars are NOT visible. Make any desired</span></div><div class="line">                    <span class="comment">// adjustments to your UI, such as hiding the action bar or</span></div><div class="line">                    <span class="comment">// other navigational controls.</span></div><div class="line">                  </div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;);</div></pre></td></tr></table></figure>
</li>
<li><p>Material Design </p>
<p>定制状态栏</p>
<p><img src="https://developer.android.google.cn/training/material/images/ThemeColors.png" alt="状态栏"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//当recycleview宽高不变时增删改查时提高性能</span></div><div class="line">mRecyclerView.setHasFixedSize(<span class="keyword">true</span>);</div></pre></td></tr></table></figure>
<p>阴影</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Z = elevation + translationZ</div><div class="line"><span class="comment">//自定义阴影轮廓，因为实际轮廓都是正方形</span></div><div class="line">扩展 ViewOutlineProvider 类别。</div><div class="line">替代 getOutline() 方法。</div><div class="line">利用 View.setOutlineProvider() 方法向您的视图指定新的轮廓提供程序。</div></pre></td></tr></table></figure>
</li>
<li><p><strong>定制动画</strong></p>
<p>触摸反馈（水波纹）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//矩形边框水波纹</span></div><div class="line">android:background=<span class="string">"?android:attr/selectableItemBackground"</span></div><div class="line"></div><div class="line"><span class="comment">//无边框限制水波纹</span></div><div class="line">android:background=<span class="string">"?android:attr/selectableItemBackgroundBorderless"</span></div></pre></td></tr></table></figure>
<p>揭露动画</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// create the animator for this view (the start radius is zero)</span></div><div class="line">Animator anim =</div><div class="line">    ViewAnimationUtils.createCircularReveal(myView, cx, cy, <span class="number">0</span>, finalRadius);</div></pre></td></tr></table></figure>
<p>​</p>
</li>
</ul>
]]></content>
      
        <categories>
            
            <category> 笔记 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> 笔记 </tag>
            
            <tag> 官网基础 </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[动画]]></title>
      <url>/2018/01/07/%E5%8A%A8%E7%94%BB/</url>
      <content type="html"><![CDATA[<h2 id="动画笔记"><a href="#动画笔记" class="headerlink" title="动画笔记"></a>动画笔记</h2><blockquote>
<p>作者：彭欢亮  </p>
<p>时间：2018/1/7 星期日 上午 10:10:10 </p>
</blockquote>
<p><strong>Android 动画的分类 ：</strong> </p>
<h3 id="一、帧动画"><a href="#一、帧动画" class="headerlink" title="一、帧动画"></a>一、帧动画</h3><blockquote>
<p>实现帧动画的两种方式 </p>
</blockquote>
<ol>
<li>利用xml形式实现</li>
</ol>
<blockquote>
<p>在drawable目录下创建一个animation-list xml 文件，</p>
</blockquote>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">	&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"utf-8"</span>?&gt;</div><div class="line">&lt;animation-list xmlns:android=<span class="string">"http://schemas.android.com/apk/res/android"</span>&gt;</div><div class="line">&lt;item</div><div class="line">    android:drawable=<span class="string">"@mipmap/ic_setup"</span></div><div class="line">    android:duration=<span class="string">"500"</span> /&gt;</div><div class="line"></div><div class="line">&lt;item</div><div class="line">    android:drawable=<span class="string">"@mipmap/ic_should_get"</span></div><div class="line">    android:duration=<span class="string">"500"</span> /&gt;</div><div class="line"></div><div class="line">&lt;item</div><div class="line">    android:drawable=<span class="string">"@mipmap/ic_should_pay"</span></div><div class="line">    android:duration=<span class="string">"500"</span> /&gt;</div><div class="line">&lt;/animation-list&gt;</div></pre></td></tr></table></figure>
<blockquote>
<p>MainActivity代码</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">ImageView imageView = (ImageView) findViewById(R.id.iv);</div><div class="line">imageView.setImageResource(R.drawable.animation_z);</div><div class="line">AnimationDrawable animation = (AnimationDrawable) imageView.getDrawable();</div><div class="line"><span class="comment">//        animation.start();</span></div><div class="line"><span class="comment">//将animationDrawable设置为imageView的背景</span></div><div class="line">imageView.setBackground(animation);</div></pre></td></tr></table></figure>
<ol>
<li>帧动画实现的第二种方式，利用代码实现 （使用场景：帧动画图片太多的情况下，建议使用此方法，不用在xml文件中一个个添加）</li>
</ol>
<blockquote>
<p>MainActivity</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">ImageView imageView = (ImageView) findViewById(R.id.iv)</div><div class="line">AnimationDrawable anim = <span class="keyword">new</span> AnimationDrawable();</div><div class="line">anim.addFrame(bit2dra(R.mipmap.ic_setup), <span class="number">200</span>);</div><div class="line">anim.addFrame(bit2dra(R.mipmap.ic_should_get), <span class="number">200</span>);</div><div class="line">anim.addFrame(bit2dra(R.mipmap.ic_should_pay), <span class="number">200</span>);</div><div class="line">anim.setOneShot(<span class="keyword">false</span>);</div><div class="line">imageView.setImageDrawable(anim);</div><div class="line"></div><div class="line"><span class="comment">//bit2dra 将bitmap转换为drawable对象</span></div><div class="line"><span class="function"><span class="keyword">private</span> Drawable <span class="title">bit2dra</span><span class="params">(<span class="keyword">int</span> sourceId)</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">new</span> BitmapDrawable(getResources(), BitmapFactory.decodeResource(getResources(), sourceId));</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>其中 anim.setOneShot(boolean arg) 表示 ：帧动画是否执行一次 true表示执行一次，false表示循环</p>
<h3 id="二、补间动画"><a href="#二、补间动画" class="headerlink" title="二、补间动画"></a>二、补间动画</h3><ul>
<li>补间动画的分类：</li>
</ul>
<p>补间动画又可以分为四种形式，分别是 alpha（淡入淡出），translate（位移），scale（缩放大小），rotate（旋转）。</p>
<blockquote>
<p>补间动画实现方式：</p>
</blockquote>
<ol>
<li>利用xml实现</li>
</ol>
<p>首先在res目录下创建一个anim文件夹，即我们xml实现补间动画都是在res/anim/目录下添加</p>
<p><strong>alpha_anim.xml动画实现</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"utf-8"</span>?&gt;</div><div class="line">&lt;alpha xmlns:android=<span class="string">"http://schemas.android.com/apk/res/android"</span></div><div class="line">android:duration=<span class="string">"1000"</span></div><div class="line">android:fromAlpha=<span class="string">"1.0"</span></div><div class="line">android:interpolator=<span class="string">"@android:anim/accelerate_decelerate_interpolator"</span></div><div class="line">android:toAlpha=<span class="string">"0"</span> /&gt;</div></pre></td></tr></table></figure>
<p><strong>scale_anim.xml动画实现</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"utf-8"</span>?&gt;</div><div class="line">&lt;scale xmlns:android=<span class="string">"http://schemas.android.com/apk/res/android"</span></div><div class="line">android:duration=<span class="string">"1000"</span></div><div class="line">android:fromXScale=<span class="string">"1.0"</span></div><div class="line">android:fromYScale=<span class="string">"1.0"</span></div><div class="line">android:pivotX=<span class="string">"50%"</span></div><div class="line">android:pivotY=<span class="string">"50%"</span></div><div class="line">android:toXScale=<span class="string">"0.0"</span></div><div class="line">android:toYScale=<span class="string">"0.0"</span> /&gt;</div></pre></td></tr></table></figure>
<p>集合动画</p>
<p><strong>set_anim.xml动画集合</strong></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"utf-8"</span>?&gt;</div><div class="line">&lt;set xmlns:android=<span class="string">"http://schemas.android.com/apk/res/android"</span></div><div class="line">android:duration=<span class="string">"持续时间"</span></div><div class="line">android:interpolator=<span class="string">"@[package:]anim/interpolator_resource"</span></div><div class="line">android:shareInterpolator=<span class="string">"boolean"</span>&gt;</div><div class="line"></div><div class="line">&lt;alpha</div><div class="line">    android:fromAlpha=<span class="string">"float"</span></div><div class="line">    android:toAlpha=<span class="string">"float"</span> /&gt;</div><div class="line"></div><div class="line">&lt;scale</div><div class="line">    android:fromXScale=<span class="string">"float"</span></div><div class="line">    android:fromYScale=<span class="string">"float"</span></div><div class="line">    android:pivotX=<span class="string">"float"</span></div><div class="line">    android:pivotY=<span class="string">"float"</span></div><div class="line">    android:toXScale=<span class="string">"float"</span></div><div class="line">    android:toYScale=<span class="string">"float"</span> /&gt;</div><div class="line"></div><div class="line">&lt;translate</div><div class="line">    android:fromXDelta=<span class="string">"float"</span></div><div class="line">    android:fromYDelta=<span class="string">"float"</span></div><div class="line">    android:toXDelta=<span class="string">"float"</span></div><div class="line">    android:toYDelta=<span class="string">"float"</span> /&gt;</div><div class="line"></div><div class="line">&lt;rotate</div><div class="line">    android:fromDegrees=<span class="string">"float"</span></div><div class="line">    android:pivotX=<span class="string">"float"</span></div><div class="line">    android:pivotY=<span class="string">"float"</span></div><div class="line">    android:toDegrees=<span class="string">"float"</span> /&gt;</div><div class="line"></div><div class="line">&lt;/set&gt;</div></pre></td></tr></table></figure>
<p><strong>MainActivity代码</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">ImageView imageView = (ImageView) findViewById(R.id.iv);</div><div class="line">Animation animation = AnimationUtils.loadAnimation(<span class="keyword">this</span>, R.anim.scale_anim);</div><div class="line">imageView.startAnimation(animation);</div></pre></td></tr></table></figure>
<p>AnimationUtils是系统实现的动画工具类</p>
<p><img src="http://yychat.oss-cn-hangzhou.aliyuncs.com/images/table.png.png" alt=""></p>
<ol>
<li>补间动画通过代码实现</li>
</ol>
<p><strong>代码如下：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">alpha</span><span class="params">(View v)</span></span>&#123;</div><div class="line">AlphaAnimation anim = <span class="keyword">new</span> AlphaAnimation(<span class="number">0.0f</span>, <span class="number">1.0f</span>);</div><div class="line">anim.setDuration(<span class="number">1000</span>);</div><div class="line">v.startAnimation(anim);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">rotate</span><span class="params">(View v)</span></span>&#123;</div><div class="line">RotateAnimation anim = <span class="keyword">new</span> RotateAnimation(<span class="number">0.0f</span>, -<span class="number">360f</span>, v.getWidth()/<span class="number">2</span>, v.getHeight()/<span class="number">2</span>);</div><div class="line">anim.setDuration(<span class="number">1000</span>);</div><div class="line">v.startAnimation(anim);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">scale</span><span class="params">(View v)</span></span>&#123;</div><div class="line">ScaleAnimation anim = <span class="keyword">new</span> ScaleAnimation(<span class="number">1.0f</span>, <span class="number">0.0f</span>, <span class="number">0.0f</span>, <span class="number">1.0f</span>, v.getWidth() / <span class="number">2</span>, v.getHeight() / <span class="number">2</span>);</div><div class="line">anim.setDuration(<span class="number">1000</span>);</div><div class="line">v.startAnimation(anim);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">translate</span><span class="params">(View v)</span></span>&#123;</div><div class="line">TranslateAnimation anim = <span class="keyword">new</span> TranslateAnimation(<span class="number">0.0f</span>, <span class="number">10.0f</span>, <span class="number">100f</span>, <span class="number">200f</span>);</div><div class="line">anim.setDuration(<span class="number">1000</span>);</div><div class="line">v.startAnimation(anim);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">set</span><span class="params">(View v)</span></span>&#123;</div><div class="line">AnimationSet anim = <span class="keyword">new</span> AnimationSet(<span class="keyword">this</span>, <span class="keyword">null</span>);</div><div class="line">AlphaAnimation alpha = <span class="keyword">new</span> AlphaAnimation(<span class="number">0.0f</span>, <span class="number">1.0f</span>);</div><div class="line">RotateAnimation rotate = <span class="keyword">new</span> RotateAnimation(<span class="number">0.0f</span>, -<span class="number">360f</span>, v.getWidth()/<span class="number">2</span>, v.getHeight()/<span class="number">2</span>);</div><div class="line">anim.setDuration(<span class="number">1000</span>);</div><div class="line">anim.addAnimation(alpha);</div><div class="line">anim.addAnimation(rotate);</div><div class="line">v.startAnimation(anim);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="三、-Android-属性动画（Property-Animation）"><a href="#三、-Android-属性动画（Property-Animation）" class="headerlink" title="三、 Android 属性动画（Property Animation）"></a>三、 Android 属性动画（Property Animation）</h3><blockquote>
<p>属性动画相关的类：</p>
</blockquote>
<ol>
<li>ObjectAnimator (动画的执行类)</li>
<li>ValueAnimator (动画的执行类)</li>
<li>AnimatorSet (用于控制一组动画的执行：线性，一起，每个动画的先后执行等)</li>
<li>AnimatorInflater （ 用户加载属性动画的xml文件）</li>
<li>TypeEvaluator （类型估值，主要用于设置动画操作属性的值）</li>
<li>TimeInterpolator（时间插值） </li>
</ol>
<p><strong>属性动画与补间动画的区别：</strong></p>
<p>补间动画有一个最大的缺陷，就是它只是改变了View的显示效果而已，并不会真正的改变View的属性。场景：如果要改变view的宽度，补间动画实现不了，而属性动画可以。</p>
<p><strong>ObjectAnimator用法</strong></p>
<blockquote>
<p>ObjectAnimator提供了几个方法（ofInt、ofFloat、ofObject…），都是用来设置动画作用的元素、作用的属性、动画开始、结束、以及中间的任意个属性值。</p>
</blockquote>
<ul>
<li>translationX、translationY：这两个属性作为一种增量来控制着View对象从它布局容器的左上角坐标开始的位置。</li>
<li>rotation、rotationX、rotationY：这三个属性控制着View对象围绕它的支点进行2D和3D的旋转。</li>
<li>scaleX和scaleY：这两个属性控制着View对象围绕它的支点进行2D缩放。</li>
<li>pivotX和pivotY：这两个属性控制着View对象的支点位置，围绕这个支点进行旋转和缩放变换处理。默认情况下，该支点的位置就是View对象的中心点。</li>
<li>alpha：它表示View对象的alpha透明度。</li>
<li>x、y：这是两个简单的实用的属性，它描述了View对象在它的容器中最终的位置。</li>
<li>BackgroundColor：改变背景颜色</li>
</ul>
<blockquote>
<p>注意 缩放、反转等都有中心点或者轴，默认中心缩放，和中间对称线为反转线</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">ObjectAnimator.ofFloat(imageView,<span class="string">"rotationX"</span>,<span class="number">0.0f</span>,<span class="number">360</span>.f,<span class="number">90.0f</span>,<span class="number">360.0f</span>)</div><div class="line">           .setDuration(<span class="number">2000</span>)</div><div class="line">           .start();</div></pre></td></tr></table></figure>
<blockquote>
<p>PropertyValuesHolder：以先将动画属性和值暂时的存储起来，后一起执行，在有些时候可以使用替换掉AnimatorSet，减少代码量。</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">PropertyValuesHolder scaleX = PropertyValuesHolder.ofFloat(<span class="string">"scaleX"</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0.5f</span>);</div><div class="line">   PropertyValuesHolder scaleY = PropertyValuesHolder.ofFloat(<span class="string">"scaleY"</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0.5f</span>);</div><div class="line">   PropertyValuesHolder alpha = PropertyValuesHolder.ofFloat(<span class="string">"alpha"</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0.5f</span>);</div><div class="line">   ObjectAnimator.ofPropertyValuesHolder(imageView,scaleX,scaleY,alpha)</div><div class="line">           .setDuration(<span class="number">2000</span>)</div><div class="line">           .start();</div></pre></td></tr></table></figure>
<p>ObjectAnimator简单的用法介绍完毕下面开始介绍ValueAnimator</p>
<p><strong>ValueAnimator介绍以及用法</strong></p>
<p>ValueAnimator是整个属性动画中最核心的一个类，前面介绍的ObjectAnimator也是继承自ValueAnimator。通过前面对ObjectAnimator的介绍，我们知道属性动画的实现机制是通过不断的地对View属性进行操作来实现的，而初始值和结束值之间的动画过渡就是由ValueAnimator这个类负责计算的。 </p>
<p>它的内部使用一种时间循环的机制来计算值与值之间的动画过渡，我们只需要将初始值和结束值提供给ValueAnimator，并且告诉它动画所需运行的时长，那么ValueAnimator就会自动帮助我们完成从初始值平滑过渡到结束值这样的效果。 </p>
<p>ValueAnimator本身不提供任何动画效果，它更像一个数值发生器，用来产生具有一定规律的数字，从而让调用者来控制动画的实现过程。通常情况下，在ValueAnimator的AnimatorUpdateListener中监听数值的变化，从而完成动画的切换。</p>
<blockquote>
<p>实现一个计时器效果</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">startTimeClock</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="keyword">final</span> ValueAnimator valueAnimator = ValueAnimator.ofInt(<span class="number">0</span>, <span class="number">60</span>);</div><div class="line">valueAnimator.setDuration(<span class="number">1000</span> * <span class="number">60</span>);</div><div class="line">valueAnimator.addUpdateListener(<span class="keyword">new</span> ValueAnimator.AnimatorUpdateListener() &#123;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationUpdate</span><span class="params">(ValueAnimator animation)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> time = (<span class="keyword">int</span>) valueAnimator.getAnimatedValue();</div><div class="line">        Log.e(TAG, <span class="string">"time="</span> + time);</div><div class="line">        mTextView.setText(time + <span class="string">""</span>);</div><div class="line">    &#125;</div><div class="line">&#125;);</div><div class="line">valueAnimator.start();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>实现一个物体自由落体</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">verticalRun</span><span class="params">(View view)</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> mHeight = getResources().getDisplayMetrics().heightPixels;</div><div class="line">    ValueAnimator animator = ValueAnimator.ofFloat(<span class="number">0</span>, mHeight - mBlueBall.getHeight());</div><div class="line">    animator.setTarget(mBlueBall);</div><div class="line">    animator.setDuration(<span class="number">1000</span>)</div><div class="line">            .start();</div><div class="line">    animator.addUpdateListener(<span class="keyword">new</span> ValueAnimator.AnimatorUpdateListener()</div><div class="line">    &#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationUpdate</span><span class="params">(ValueAnimator animation)</span></span></div><div class="line"><span class="function">        </span>&#123;</div><div class="line">            Float value = (Float) animation.getAnimatedValue();</div><div class="line">            Log.e(TAG, <span class="string">"onAnimationUpdate: value = "</span>+value );</div><div class="line"></div><div class="line">            mBlueBall.setTranslationY((Float) animation.getAnimatedValue());</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>动画的监听事件</strong></p>
<ol>
<li>animator.addListener(AnimatorListener、AnimatorUpdateListener 对象)</li>
</ol>
<blockquote>
<p>实现AnimatorLisener对象</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">animator.addListener(<span class="keyword">new</span> Animator.AnimatorListener() &#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationStart</span><span class="params">(Animator animation)</span> </span>&#123;</div><div class="line"></div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationEnd</span><span class="params">(Animator animation)</span> </span>&#123;</div><div class="line"></div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationCancel</span><span class="params">(Animator animation)</span> </span>&#123;</div><div class="line"></div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationRepeat</span><span class="params">(Animator animation)</span> </span>&#123;</div><div class="line"></div><div class="line">        &#125;</div><div class="line">   &#125;);</div></pre></td></tr></table></figure>
<blockquote>
<p>实现AnimatorUpdateListener对象</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">animator.addListener(<span class="keyword">new</span> AnimatorListenerAdapter() &#123;</div><div class="line">       <span class="meta">@Override</span></div><div class="line">       <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationEnd</span><span class="params">(Animator animation)</span> </span>&#123;</div><div class="line"></div><div class="line">       &#125;</div><div class="line">   &#125;);</div></pre></td></tr></table></figure>
<blockquote>
<p>实现AnimatorLisener、AnimatorUpdateListener 区别在于：前面这个监听需要实现所有的方法，而后面这个只需要实现其中一种方法即可。</p>
</blockquote>
<ol>
<li>animator.addUpdateListener(AnimatorUpdateListener)</li>
</ol>
<p>上面有个计时器的例子，可以通过实现的方法onAnimationUpdate（ValueAnimator animation）拿到相应的对象</p>
<p><strong>AnimatorSet介绍与使用</strong></p>
<p>介绍：动画的集合，在补间动画中也有个一个动画的集合类AnimationSet,所以AnimatorSet同样的效果，可以帮助我们实现组合属性动画的效果。</p>
<p>AnimatorSet这个类提供了一个play()方法，如果我们向这个方法中传入一个Animator对象(ObjectAnimator或者ValueAnimator)将会返回一个AnimatorSet.Builder的实例，AnimatorSet.Builder中包含了以下四个方法：</p>
<ul>
<li>after(Animator anim) ： 将现有动画插入到传入的动画之后执行。</li>
<li>after(long delay)：将现有的动画延迟指定的毫秒后执行。</li>
<li>before(Animator anim)：将现有的动画插入到传入的动画之前执行。</li>
<li>with(Animator anim)：将现有的动画和传入的动画同时执行。</li>
</ul>
<p>例如我们想让一个TextView先从屏幕外移动到屏幕内，然后旋转360度，同时旋转过程中进行淡入淡出的效果，就可以写出如下代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">multiAnimator</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="comment">// 移动动画</span></div><div class="line">ObjectAnimator transAnimator = ObjectAnimator.ofFloat(mTextView, <span class="string">"translationX"</span>, -<span class="number">500f</span>, <span class="number">300f</span>);</div><div class="line"></div><div class="line"><span class="comment">// 旋转动画</span></div><div class="line">ObjectAnimator rotationAnimator = ObjectAnimator.ofFloat(mTextView, <span class="string">"rotation"</span>, <span class="number">0f</span>, <span class="number">360f</span>);</div><div class="line"></div><div class="line"><span class="comment">// 淡入淡出</span></div><div class="line">ObjectAnimator alphaAnimator = ObjectAnimator.ofFloat(mTextView, <span class="string">"alpha"</span>, <span class="number">1f</span>, <span class="number">0f</span>, <span class="number">1f</span>);</div><div class="line"></div><div class="line">AnimatorSet animatorSet = <span class="keyword">new</span> AnimatorSet();</div><div class="line">animatorSet.play(rotationAnimator).with(alphaAnimator).after(transAnimator);</div><div class="line">animatorSet.setDuration(<span class="number">5000</span>);</div><div class="line">animatorSet.setInterpolator(<span class="keyword">new</span> LinearInterpolator());</div><div class="line">animatorSet.start();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>Animator监听器</strong></p>
<p>一个完整的动画具有start、Repeat、End、Cancel四个过程，Android提供了接口，让我们能够很容易监听到这些事件。示例代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">animatorSet.addListener(<span class="keyword">new</span> Animator.AnimatorListener() &#123;</div><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationStart</span><span class="params">(Animator animation)</span> </span>&#123;</div><div class="line">    Log.e(TAG, <span class="string">"onAnimationStart"</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationEnd</span><span class="params">(Animator animation)</span> </span>&#123;</div><div class="line">    Log.e(TAG, <span class="string">"onAnimationEnd"</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationCancel</span><span class="params">(Animator animation)</span> </span>&#123;</div><div class="line">    Log.e(TAG, <span class="string">"onAnimationCancel"</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationRepeat</span><span class="params">(Animator animation)</span> </span>&#123;</div><div class="line">    Log.e(TAG, <span class="string">"onAnimationRepeat"</span>);</div><div class="line">&#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p><strong>使用xml文件创建属性动画</strong></p>
<ol>
<li>在res下创建一个animator的文件夹，即res/animator/.xml</li>
</ol>
<p><strong>例如：sacleX.xml</strong></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"utf-8"</span>?&gt;  </div><div class="line">&lt;objectAnimator xmlns:android=<span class="string">"http://schemas.android.com/apk/res/android"</span>  </div><div class="line">android:duration=<span class="string">"1000"</span>  </div><div class="line">android:propertyName=<span class="string">"scaleX"</span>  </div><div class="line">android:valueFrom=<span class="string">"1.0"</span>  </div><div class="line">android:valueTo=<span class="string">"2.0"</span>  </div><div class="line">android:valueType=<span class="string">"floatType"</span> &gt;  </div><div class="line">&lt;/objectAnimator&gt;</div></pre></td></tr></table></figure>
<ol>
<li>使用AnimatorInflater来加载动画的资源文件，然后设置给相应的target即可。</li>
</ol>
<p><strong>MainActivity.java 代码如下：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">loadXml</span><span class="params">(View view)</span> </span>&#123;</div><div class="line">Animator animator = AnimatorInflater.loadAnimator(<span class="keyword">this</span>, R.animator.scalex);</div><div class="line">animator.setTarget(mBlueBall);</div><div class="line">animator.start();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>其它类似一致，下面讲解利用xml实现属性动画集合</p>
<p><strong>animator_set</strong></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"utf-8"</span>?&gt;  </div><div class="line">&lt;set xmlns:android=<span class="string">"http://schemas.android.com/apk/res/android"</span>  </div><div class="line">android:ordering=<span class="string">"together"</span> &gt;  </div><div class="line">  </div><div class="line">&lt;objectAnimator  </div><div class="line">    android:duration=<span class="string">"1000"</span>  </div><div class="line">    android:propertyName=<span class="string">"scaleX"</span>  </div><div class="line">    android:valueFrom=<span class="string">"1"</span>  </div><div class="line">    android:valueTo=<span class="string">"0.5"</span> &gt;  </div><div class="line">&lt;/objectAnimator&gt;  </div><div class="line">&lt;objectAnimator  </div><div class="line">    android:duration=<span class="string">"1000"</span>  </div><div class="line">    android:propertyName=<span class="string">"scaleY"</span>  </div><div class="line">    android:valueFrom=<span class="string">"1"</span>  </div><div class="line">    android:valueTo=<span class="string">"0.5"</span> &gt;  </div><div class="line">&lt;/objectAnimator&gt;  </div><div class="line">&lt;/set&gt;</div></pre></td></tr></table></figure>
<p>使用set标签，有一个orderring属性设置为together,还有另一个值：sequentially（表示一个接一个执行)。</p>
<p><strong>MainActivity.java代码如下</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Animator animator = AnimatorInflater.loadAnimator(<span class="keyword">this</span>, R.animator.scalex);</div><div class="line">    animator.setTarget(mBlueBall);</div><div class="line">    animator.start();</div></pre></td></tr></table></figure>
<p>代码同上。</p>
<p><strong>布局动画</strong></p>
<p>主要使用LayoutTransition为布局的容器设置动画，当容器中的视图层次发生变化时存在过渡的动画效果。（略）</p>
<p><strong>View的anim方法</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">mBlueBall.animate().alpha(<span class="number">0</span>)</div><div class="line">            .y(<span class="number">200</span>)</div><div class="line">            .setDuration(<span class="number">3000</span>)</div><div class="line">            .withStartAction(<span class="keyword">new</span> Runnable() &#123;</div><div class="line">                <span class="meta">@Override</span></div><div class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">                    Log.e(TAG, <span class="string">"run: withStartAction"</span>);</div><div class="line">                &#125;</div><div class="line">            &#125;)</div><div class="line">            .withEndAction(<span class="keyword">new</span> Runnable() &#123;</div><div class="line">                <span class="meta">@Override</span></div><div class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">                    Log.e(TAG, <span class="string">"run: withEndAction"</span>);</div><div class="line">                &#125;</div><div class="line">            &#125;)</div><div class="line">            .start();</div></pre></td></tr></table></figure>
<blockquote>
<p><strong>属性动画原理</strong></p>
</blockquote>
<p>属性动画要求动画作用的对象提供该属性的get和set方法，属性动画根据你传递的该熟悉的初始值和最终值，以动画的效果多次去调用set方法，每次传递给set方法的值都不一样，确切来说是随着时间的推移，所传递的值越来越接近最终值。如果让属性动画生效，要同时满足两个条件：</p>
<ol>
<li>object必须要提供setXxx方法，如果动画的时候没有传递初始值，那么还要提供getXxx方法，因为系统要去拿xxx属性的初始值（如果这条不满足，程序直接Crash）</li>
<li>object的setXxx对属性xxx所做的改变必须能够通过某种方法反映出来，比如会带来ui的改变啥的（如果这条不满足，动画无效果但不会Crash）</li>
</ol>
<blockquote>
<p>属性动画为什么不能改变Button的宽高</p>
</blockquote>
<p>因为Button的内部并没有自己的getWith()、setWidth()方法，为什么这样说，button继承至TextView,持有TextView的get、set方法。所以我们对Button做宽高的改变是，没有 效果的。</p>
<ol>
<li><strong>解决方法 1 ： 用一个类来包装原始对象，间接为其提供get和set方法</strong></li>
</ol>
<blockquote>
<p>包装类如下：</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ViewWrapper</span> </span>&#123;</div><div class="line"></div><div class="line"><span class="keyword">private</span> View mView;</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="title">ViewWrapper</span><span class="params">(View mView)</span> </span>&#123;</div><div class="line">    <span class="keyword">this</span>.mView = mView;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setWidth</span><span class="params">(<span class="keyword">int</span> width)</span> </span>&#123;</div><div class="line">    mView.getLayoutParams().width = width;</div><div class="line">    mView.requestLayout();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getWidth</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> mView.getLayoutParams().width;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setHeight</span><span class="params">(<span class="keyword">int</span> height)</span> </span>&#123;</div><div class="line">    mView.getLayoutParams().height = height;</div><div class="line">    mView.requestLayout();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getHeight</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> mView.getLayoutParams().height;</div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>MainActivity.java 代码：</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">ViewWrapper viewWrapper = <span class="keyword">new</span> ViewWrapper(mBtn);</div><div class="line">PropertyValuesHolder proW = PropertyValuesHolder.ofInt(<span class="string">"width"</span>, width, width * <span class="number">2</span>);</div><div class="line">PropertyValuesHolder proH = PropertyValuesHolder.ofInt(<span class="string">"height"</span>, height, height * <span class="number">3</span>);</div><div class="line">ObjectAnimator objectAnimator = ObjectAnimator.ofPropertyValuesHolder(viewWrapper, proW, proH);</div><div class="line"></div><div class="line">objectAnimator.setDuration(<span class="number">3000</span>).start();</div></pre></td></tr></table></figure>
<ol>
<li><strong>解决方法2： 采用ValueAnimator，监听动画过程，自己实现属性的改变</strong></li>
</ol>
<p>例子：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">performAnimate</span><span class="params">(<span class="keyword">final</span> View mTarget, <span class="keyword">final</span> <span class="keyword">int</span> start, <span class="keyword">final</span> <span class="keyword">int</span> end)</span> </span>&#123;</div><div class="line">    ValueAnimator valueAnimator = ValueAnimator.ofInt(<span class="number">1</span>, <span class="number">100</span>);</div><div class="line">    valueAnimator.addUpdateListener(<span class="keyword">new</span> ValueAnimator.AnimatorUpdateListener() &#123;</div><div class="line">        <span class="comment">//持有一个IntEvaluator对象，用来估值使用</span></div><div class="line">        <span class="keyword">private</span> IntEvaluator mEvaluator = <span class="keyword">new</span> IntEvaluator();</div><div class="line"></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationUpdate</span><span class="params">(ValueAnimator animation)</span> </span>&#123;</div><div class="line">            <span class="comment">//获得当前动画的进度</span></div><div class="line">            <span class="keyword">int</span> value = (Integer) animation.getAnimatedValue();</div><div class="line">            Log.e(TAG, <span class="string">"onAnimationUpdate: curr value = "</span> + value);</div><div class="line">            <span class="keyword">float</span> fraction = value / <span class="number">100f</span>;</div><div class="line">            mTarget.getLayoutParams().width = mEvaluator.evaluate(fraction, start, end);</div><div class="line">            mTarget.requestLayout();</div><div class="line">            mTarget.invalidate();</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">    valueAnimator.setDuration(<span class="number">3000</span>).start();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>用ValueAnimator来做动画。ValueAnimator并不会实质的做什么。所以需要后面的AnimatorUpdateListener来做一些粗活儿。这里指定的从1到100也没有什么实质的作用。并不是把按钮的宽度从1变到100。后面的代码很清晰的表达了这一点。</li>
<li>据这个fraction的百分比来计算当前时间片对应的按钮宽度是多少。当前宽度 = 初始宽度 + fraction * （结束宽度 - 初始宽度）。</li>
</ul>
<p>​    </p>
]]></content>
      
        <categories>
            
            <category> 动画 </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Android </tag>
            
            <tag> 动画 </tag>
            
        </tags>
        
    </entry>
    
  
  
</search>
